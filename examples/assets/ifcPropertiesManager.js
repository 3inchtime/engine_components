import{a0 as R,bn as t,a4 as d,a3 as w}from"./web-ifc-api-B6ue9hUU.js";import{C as U,I as v,d as L,f as B,U as I}from"./index-wVK0dhyV.js";const l=new U,b=l.get(v);await b.setup();const F=await fetch("/resources/spaces.ifc"),E=await F.arrayBuffer(),e=await b.load(new Uint8Array(E)),r=l.get(L);await r.process(e);const o=l.get(B),{ownerHistoryHandle:p}=await o.getOwnerHistory(e),m=await e.getAllPropertiesOfType(R);var y,D;if(m)for(const s in m){const a=new t.IfcPropertySingleValue(new t.IfcIdentifier("PubliclyAccessible"),null,new t.IfcBoolean(!0),null);a.NominalValue&&(a.NominalValue.value=Math.random()>=.5),await o.setData(e,a);const n=new t.IfcPropertySet(new t.IfcGloballyUniqueId(I.create()),p,new t.IfcLabel("Pset_SpaceCommon"),null,[new d(a.expressID)]);await o.setData(e,n),r.addEntitiesRelation(e,n.expressID,{type:w,inv:"DefinesOcurrence"},Number(s));const g=r.getEntityRelations(e,Number(s),"IsDefinedBy");for(const P of g){const c=await e.getProperties(P);if(c&&((y=c.Name)==null?void 0:y.value)==="Dimensiones")for(const{value:A}of c.HasProperties){const i=await e.getProperties(A);if(!(i&&((D=i.Name)==null?void 0:D.value)==="Area"&&i.NominalValue))continue;const{value:N}=i.NominalValue,f=new t.IfcQuantityArea(new t.IfcIdentifier("NetFloorArea"),null,null,new t.IfcAreaMeasure(N));await o.setData(e,f);const u=new t.IfcElementQuantity(new t.IfcGloballyUniqueId(I.create()),p,new t.IfcLabel("Qto_SpaceBaseQuantities"),null,null,[new d(f.expressID)]);await o.setData(e,u),r.addEntitiesRelation(e,u.expressID,{type:w,inv:"DefinesOcurrence"},Number(s))}}}const C=document.getElementById("download-btn");C.addEventListener("click",async()=>{const s=await o.saveToIfc(e,new Uint8Array(E)),a=new File([s],"small-modified.ifc"),n=document.createElement("a");n.href=URL.createObjectURL(a),n.download=a.name,n.click(),URL.revokeObjectURL(n.href)});
