var E=Object.defineProperty;var V=(t,r,o)=>r in t?E(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o;var m=(t,r,o)=>(V(t,typeof r!="symbol"?r+"":r,o),o);import{C as M}from"./web-ifc-api-BiYij3qq.js";import{S as A}from"./stats.min-GTpOrGrX.js";import{a as x,b as K,C as O}from"./index-Ca45K5im.js";import"./index-B3b_h8A8.js";import"./import-wrapper-prod-vMwJRSad.js";import{P as B}from"./index-Cb-lnTew.js";import{C as N}from"./index-Bn4wotfq.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./curve-highlighter-B2XYj340.js";import"./Line2-Bd8FUlMY.js";import"./index-Bq1KDtuM.js";import"./mark-B9TqPH3U.js";import"./renderer-with-2d-Dwkf_fcQ.js";const g=class g extends x{constructor(o){super(o);m(this,"view","vertical");m(this,"enabled",!0);this.components.add(g.uuid,this)}set world(o){this.world!==o&&(super.world=o,this.highlighter&&this.highlighter.onSelect.add(S=>{if(!this.world)throw new Error("A world is needed to work with this component!");const a=this.components.get(K);a.deleteByType(["Slope","Height","InitialKPV","FinalKPV"]);const{alignment:n}=S.curve,P=[];for(const i of n.vertical){const h=i.mesh.geometry.attributes.position.array;P.push(h)}const{defSegments:C,slope:k}=this.setDefSegments(P),l=this.world.scene.three;for(let i=0;i<n.vertical.length;i++){const h=n.vertical[i];a.addVerticalMarker(this.world,`S: ${k[i].slope}%`,h.mesh,"Slope",l),a.addVerticalMarker(this.world,`H: ${C[i].end.y.toFixed(2)}`,h.mesh,"Height",l)}a.addVerticalMarker(this.world,"KP: 0",n.vertical[0].mesh,"InitialKPV",l),a.addVerticalMarker(this.world,`KP: ${n.vertical.length}`,n.vertical[n.vertical.length-1].mesh,"FinalKPV",l)}))}};m(g,"uuid","097eea29-2d5a-431a-a247-204d44670621");let f=g;const T=document.getElementById("container"),e=new(void 0),I=new(void 0)(e);I.setup();e.scene=I;const s=new B(e,T);e.renderer=s;const w=new(void 0)(e);e.camera=w;e.raycaster=new(void 0)(e);e.init();s.postproduction.enabled=!0;s.postproduction.customEffects.outlineEnabled=!0;w.controls.setLookAt(12,6,8,0,0,-10);const F=new(void 0)(e,new M(6710886)),H=s.postproduction.customEffects;H.excludedMeshes.push(F.get());const R=new(void 0)(e),v=new(void 0)(e);v.settings.wasm={path:"https://unpkg.com/web-ifc@0.0.50/",absolute:!0};v.settings.webIfc.COORDINATE_TO_ORIGIN=!0;v.settings.webIfc.OPTIMIZE_PROFILES=!0;const _=await fetch("../../../resources/asdf.frag"),D=await _.arrayBuffer(),L=new Uint8Array(D),b=await R.load(L),c=new N(e);c.draw(b);c.setup();c._highlighter.hoverCurve.material.color.set(1,1,1);const{material:u}=c._highlighter.hoverPoints;if(Array.isArray(u)){const t=u[0];"color"in t&&t.color.set(1,1,1)}else"color"in u&&u.color.set(1,1,1);const y=new O(e),U=y.uiElement.get("floatingWindow");U.visible=!0;y.draw(b);const p=new f(e),$=p.uiElement.get("drawer");$.visible=!0;y.onHighlight.add(({mesh:t})=>{p.clear(),p.draw(b,[t.curve.alignment]),p.highlighter.select(t),c._highlighter.select(t);const r=t.curve.index,o=t.curve.alignment.absolute[r];o.mesh.geometry.computeBoundingSphere(),w.controls.fitToSphere(o.mesh.geometry.boundingSphere,!0)});const d=new A;d.showPanel(2);document.body.append(d.dom);d.dom.style.left="0px";s.onBeforeUpdate.add(()=>d.begin());s.onAfterUpdate.add(()=>d.end());
