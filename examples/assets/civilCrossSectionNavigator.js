import{C as E,L as M}from"./web-ifc-api-CwSt8Jc1.js";import{p as B,C as S,s as k,n as A,d as C,u as D,A as v}from"./index-CflsZ4Kv.js";import{p as x}from"./index-K5IA6oiZ.js";import{s as I}from"./index-lyIQfD7o.js";import{S as L}from"./stats.min-BpIepu9J.js";import{U,c as P,g as j,E as H,p as N}from"./index-fF5MlFyv.js";x.init();I.init();const y=document.getElementById("container"),e=new B,W=e.get(S),t=W.create();t.scene=new k(e);t.renderer=new U(e,y);t.camera=new A(e);e.init();t.scene.setup();t.camera.controls.setLookAt(5,5,5,0,0,0);y.appendChild(t.renderer.three2D.domElement);const _=e.get(C);_.create(t);t.scene.three.background=null;const b=e.get(D),z=await fetch("https://thatopen.github.io/engine_components/resources/road.frag"),F=await z.arrayBuffer(),R=new Uint8Array(F),d=b.load(R);t.scene.three.add(d);const T=await fetch("https://thatopen.github.io/engine_components/resources/road.json");d.setLocalProperties(await T.json());const p=document.getElementById("scene-2d-left");p.components=e;if(!p.world)throw new Error("World not found!");const c=e.get(P);c.world=p.world;await c.draw(d);const l=e.get(j);l.world=t;l.draw(d);const g=document.getElementById("scene-2d-right");g.components=e;if(!g.world)throw new Error("World not found!");const f=e.get(H);f.world=g.world;f.world3D=t;c.onMarkerChange.add(({alignment:o,percentage:n,type:s,curve:r})=>{if(l.setMarker(o,n,s),s==="select"){const i=r.alignment.absolute[r.index].mesh,m=o.getPointAt(n,"absolute");f.set(i,m)}});c.onHighlight.add(({mesh:o})=>{l.highlighter.select(o);const n=o.curve.index,s=o.curve.alignment.absolute[n];s.mesh.geometry.computeBoundingSphere();const r=s.mesh.geometry.boundingSphere;r&&t.camera.controls.fitToSphere(r,!0)});c.onMarkerHidden.add(({type:o})=>{l.hideMarker(o)});const h=e.get(v);h.byEntity(d);const $=h.list,w=e.get(N),u=w.styles.list;for(const o in $.entities){const n=h.find({entities:[o]}),s=new E(Math.random(),Math.random(),Math.random()),r=new M({color:s});w.styles.create(o,new Set,g.world,r);for(const i in n){const m=b.list.get(i);m&&(u[o].fragments[i]=new Set(n[i]),u[o].meshes.add(m.mesh))}}w.update(!0);const a=new L;a.showPanel(2);document.body.append(a.dom);a.dom.style.left="0px";a.dom.style.zIndex="unset";t.renderer.onBeforeUpdate.add(()=>a.begin());t.renderer.onAfterUpdate.add(()=>a.end());
